{
  "$schema": "https://raw.githubusercontent.com/sseuniverse/sse-hooks/refs/heads/main/schema/meta.json",
  "name": "use-media-quality",
  "type": "registry:hook",
  "title": "useMediaQuality",
  "description": "The current quality preset being used.",
  "dependencies": [
    "react"
  ],
  "registryDependencies": [],
  "file": {
    "content": "export type MediaQuality = \"low\" | \"medium\" | \"high\";\nexport type QualityPresetTypes = Record<MediaQuality, MediaTrackConstraints>;\n\nexport interface UseMediaQualityReturn {\n  quality: MediaQuality;\n\n  isChanging: boolean;\n\n  setQuality: (level: MediaQuality) => Promise<void>;\n}\n\nimport { useState, useCallback } from \"react\";\n\nconst QUALITY_PRESETS: QualityPresetTypes = {\n  low: {\n    width: { ideal: 320 },\n    height: { ideal: 240 },\n    frameRate: { max: 15 },\n  },\n  medium: {\n    width: { ideal: 640 },\n    height: { ideal: 480 },\n    frameRate: { max: 24 },\n  },\n  high: {\n    width: { ideal: 1280 },\n    height: { ideal: 720 },\n    frameRate: { max: 30 },\n  },\n};\n\nexport const useMediaQuality = (\n  stream: MediaStream | null,\n): UseMediaQualityReturn => {\n  const [quality, setQuality] = useState<MediaQuality>(\"high\");\n  const [isChanging, setIsChanging] = useState(false);\n\n  const applyQuality = useCallback(\n    async (level: MediaQuality) => {\n      if (!stream) return;\n      const videoTrack = stream.getVideoTracks()[0];\n      if (!videoTrack) return;\n      if (level === quality && !isChanging) return;\n\n      setIsChanging(true);\n      try {\n        await videoTrack.applyConstraints(QUALITY_PRESETS[level]);\n        setQuality(level);\n        console.log(`Video quality switched to: ${level}`);\n      } catch (err) {\n        console.warn(\"Camera hardware could not satisfy constraints:\", err);\n      } finally {\n        setIsChanging(false);\n      }\n    },\n    [stream, quality, isChanging],\n  );\n\n  return { quality, isChanging, setQuality: applyQuality };\n};\n",
    "js": "import { useState, useCallback } from \"react\";\nconst QUALITY_PRESETS = {\n    low: {\n        width: { ideal: 320 },\n        height: { ideal: 240 },\n        frameRate: { max: 15 },\n    },\n    medium: {\n        width: { ideal: 640 },\n        height: { ideal: 480 },\n        frameRate: { max: 24 },\n    },\n    high: {\n        width: { ideal: 1280 },\n        height: { ideal: 720 },\n        frameRate: { max: 30 },\n    },\n};\nexport const useMediaQuality = (stream) => {\n    const [quality, setQuality] = useState(\"high\");\n    const [isChanging, setIsChanging] = useState(false);\n    const applyQuality = useCallback(async (level) => {\n        if (!stream)\n            return;\n        const videoTrack = stream.getVideoTracks()[0];\n        if (!videoTrack)\n            return;\n        if (level === quality && !isChanging)\n            return;\n        setIsChanging(true);\n        try {\n            await videoTrack.applyConstraints(QUALITY_PRESETS[level]);\n            setQuality(level);\n            console.log(`Video quality switched to: ${level}`);\n        }\n        catch (err) {\n            console.warn(\"Camera hardware could not satisfy constraints:\", err);\n        }\n        finally {\n            setIsChanging(false);\n        }\n    }, [stream, quality, isChanging]);\n    return { quality, isChanging, setQuality: applyQuality };\n};"
  }
}