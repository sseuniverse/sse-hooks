{
  "$schema": "https://raw.githubusercontent.com/sseuniverse/sse-hooks/refs/heads/main/schema/meta.json",
  "name": "use-media-quality",
  "type": "registry:hook",
  "title": "useMediaQuality",
  "description": "",
  "dependencies": [
    "react"
  ],
  "registryDependencies": [],
  "file": {
    "content": "export type MediaQuality = \"low\" | \"medium\" | \"high\";\r\nexport type QualityPresetTypes = Record<MediaQuality, MediaTrackConstraints>;\r\n\r\nexport interface UseMediaQualityReturn {\r\n  quality: MediaQuality;\r\n  isChanging: boolean;\r\n  setQuality: (level: MediaQuality) => Promise<void>;\r\n}\r\n\nimport { useState, useCallback } from \"react\";\r\n\nconst QUALITY_PRESETS: QualityPresetTypes = {\r\n  low: {\r\n    width: { ideal: 320 },\r\n    height: { ideal: 240 },\r\n    frameRate: { max: 15 },\r\n  },\r\n  medium: {\r\n    width: { ideal: 640 },\r\n    height: { ideal: 480 },\r\n    frameRate: { max: 24 },\r\n  },\r\n  high: {\r\n    width: { ideal: 1280 },\r\n    height: { ideal: 720 },\r\n    frameRate: { max: 30 },\r\n  },\r\n};\r\n\r\nexport const useMediaQuality = (\r\n  stream: MediaStream | null,\r\n): UseMediaQualityReturn => {\r\n  const [quality, setQuality] = useState<MediaQuality>(\"high\");\r\n  const [isChanging, setIsChanging] = useState(false);\r\n\r\n  const applyQuality = useCallback(\r\n    async (level: MediaQuality) => {\r\n      if (!stream) return;\r\n      const videoTrack = stream.getVideoTracks()[0];\r\n      if (!videoTrack) return;\r\n      if (level === quality && !isChanging) return;\r\n\r\n      setIsChanging(true);\r\n      try {\r\n        await videoTrack.applyConstraints(QUALITY_PRESETS[level]);\r\n        setQuality(level);\r\n        console.log(`Video quality switched to: ${level}`);\r\n      } catch (err) {\r\n        console.warn(\"Camera hardware could not satisfy constraints:\", err);\r\n      } finally {\r\n        setIsChanging(false);\r\n      }\r\n    },\r\n    [stream, quality, isChanging],\r\n  );\r\n\r\n  return { quality, isChanging, setQuality: applyQuality };\r\n};",
    "js": "import { useState, useCallback } from \"react\";\nconst QUALITY_PRESETS = {\n    low: {\n        width: { ideal: 320 },\n        height: { ideal: 240 },\n        frameRate: { max: 15 },\n    },\n    medium: {\n        width: { ideal: 640 },\n        height: { ideal: 480 },\n        frameRate: { max: 24 },\n    },\n    high: {\n        width: { ideal: 1280 },\n        height: { ideal: 720 },\n        frameRate: { max: 30 },\n    },\n};\nexport const useMediaQuality = (stream) => {\n    const [quality, setQuality] = useState(\"high\");\n    const [isChanging, setIsChanging] = useState(false);\n    const applyQuality = useCallback(async (level) => {\n        if (!stream)\n            return;\n        const videoTrack = stream.getVideoTracks()[0];\n        if (!videoTrack)\n            return;\n        if (level === quality && !isChanging)\n            return;\n        setIsChanging(true);\n        try {\n            await videoTrack.applyConstraints(QUALITY_PRESETS[level]);\n            setQuality(level);\n            console.log(`Video quality switched to: ${level}`);\n        }\n        catch (err) {\n            console.warn(\"Camera hardware could not satisfy constraints:\", err);\n        }\n        finally {\n            setIsChanging(false);\n        }\n    }, [stream, quality, isChanging]);\n    return { quality, isChanging, setQuality: applyQuality };\n};"
  }
}