{
  "$schema": "https://raw.githubusercontent.com/sseuniverse/sse-hooks/refs/heads/main/schema/meta.json",
  "name": "use-conference-system",
  "type": "registry:hook",
  "title": "useConferenceSystem",
  "description": "",
  "dependencies": [
    "react"
  ],
  "registryDependencies": [
    "use-user-media",
    "use-screen-share",
    "use-network-information",
    "use-media-quality"
  ],
  "file": {
    "content": "import { useState, useEffect, useMemo } from \"react\";\r\n\n\n\n\ninterface UseConferenceSystemOptions {\r\n  defaultAutoQuality?: boolean;\r\n}\r\n\r\nexport const useConferenceSystem = (\r\n  options: UseConferenceSystemOptions = {},\r\n) => {\r\n  \r\n  const camera = useUserMedia();\r\n  const screen = useScreenShare();\r\n  const network = useNetworkInformation();\r\n\r\n  \r\n  const {\r\n    quality,\r\n    setQuality: applyQuality,\r\n    isChanging: isQualityChanging,\r\n  } = useMediaQuality(camera.stream);\r\n\r\n  \r\n  const [isAutoQuality, setIsAutoQuality] = useState(\r\n    options.defaultAutoQuality ?? true,\r\n  );\r\n\r\n  \r\n  useEffect(() => {\r\n    \r\n    if (!isAutoQuality || !camera.stream || !network.networkInfo) return;\r\n\r\n    const { downlink, effectiveType, saveData } = network.networkInfo;\r\n\r\n    \r\n    let targetQuality: MediaQuality = \"high\";\r\n\r\n    if (saveData) {\r\n      \r\n      targetQuality = \"low\";\r\n    } else if (effectiveType === \"2g\" || effectiveType === \"slow-2g\") {\r\n      targetQuality = \"low\";\r\n    } else if (downlink && downlink < 1.5) {\r\n      \r\n      targetQuality = \"low\";\r\n    } else if (downlink && downlink < 5) {\r\n      \r\n      targetQuality = \"medium\";\r\n    } else {\r\n      \r\n      targetQuality = \"high\";\r\n    }\r\n\r\n    \r\n    if (quality !== targetQuality) {\r\n      applyQuality(targetQuality);\r\n    }\r\n  }, [\r\n    network.networkInfo,\r\n    isAutoQuality,\r\n    camera.stream,\r\n    quality,\r\n    applyQuality,\r\n  ]);\r\n\r\n  \r\n  return {\r\n    \r\n    camera: {\r\n      stream: camera.stream,\r\n      start: camera.startCapture,\r\n      stop: camera.stopCapture,\r\n      isActive: !!camera.stream,\r\n      error: camera.error,\r\n      isLoading: camera.isLoading,\r\n    },\r\n    screen: {\r\n      stream: screen.stream,\r\n      start: screen.startCapture,\r\n      stop: screen.stopCapture,\r\n      isActive: !!screen.stream,\r\n      error: screen.error,\r\n    },\r\n\r\n    \r\n    quality: {\r\n      current: quality,\r\n      isChanging: isQualityChanging,\r\n      set: applyQuality, \r\n      isAuto: isAutoQuality,\r\n      toggleAuto: () => setIsAutoQuality((prev) => !prev),\r\n    },\r\n\r\n    \r\n    network: {\r\n      isOnline: network.isOnline,\r\n      speed: network.networkInfo?.downlink || 0, \r\n      type: network.networkInfo?.effectiveType || \"unknown\",\r\n    },\r\n  };\r\n};",
    "js": "import { useState, useEffect } from \"react\";\nexport const useConferenceSystem = (options = {}) => {\n    const camera = useUserMedia();\n    const screen = useScreenShare();\n    const network = useNetworkInformation();\n    const { quality, setQuality: applyQuality, isChanging: isQualityChanging, } = useMediaQuality(camera.stream);\n    const [isAutoQuality, setIsAutoQuality] = useState(options.defaultAutoQuality ?? true);\n    useEffect(() => {\n        if (!isAutoQuality || !camera.stream || !network.networkInfo)\n            return;\n        const { downlink, effectiveType, saveData } = network.networkInfo;\n        let targetQuality = \"high\";\n        if (saveData) {\n            targetQuality = \"low\";\n        }\n        else if (effectiveType === \"2g\" || effectiveType === \"slow-2g\") {\n            targetQuality = \"low\";\n        }\n        else if (downlink && downlink < 1.5) {\n            targetQuality = \"low\";\n        }\n        else if (downlink && downlink < 5) {\n            targetQuality = \"medium\";\n        }\n        else {\n            targetQuality = \"high\";\n        }\n        if (quality !== targetQuality) {\n            applyQuality(targetQuality);\n        }\n    }, [\n        network.networkInfo,\n        isAutoQuality,\n        camera.stream,\n        quality,\n        applyQuality,\n    ]);\n    return {\n        camera: {\n            stream: camera.stream,\n            start: camera.startCapture,\n            stop: camera.stopCapture,\n            isActive: !!camera.stream,\n            error: camera.error,\n            isLoading: camera.isLoading,\n        },\n        screen: {\n            stream: screen.stream,\n            start: screen.startCapture,\n            stop: screen.stopCapture,\n            isActive: !!screen.stream,\n            error: screen.error,\n        },\n        quality: {\n            current: quality,\n            isChanging: isQualityChanging,\n            set: applyQuality,\n            isAuto: isAutoQuality,\n            toggleAuto: () => setIsAutoQuality((prev) => !prev),\n        },\n        network: {\n            isOnline: network.isOnline,\n            speed: network.networkInfo?.downlink || 0,\n            type: network.networkInfo?.effectiveType || \"unknown\",\n        },\n    };\n};"
  }
}