{
  "$schema": "https://raw.githubusercontent.com/sseuniverse/sse-hooks/refs/heads/main/schema/meta.json",
  "name": "use-conference-system",
  "type": "registry:hook",
  "title": "useConferenceSystem",
  "description": "Configuration options for the conference system hook.",
  "dependencies": [
    "react"
  ],
  "registryDependencies": [
    "use-user-media",
    "use-screen-share",
    "use-network-information",
    "use-media-quality"
  ],
  "file": {
    "content": "import { useState, useEffect } from \"react\";\nimport { useUserMedia } from \"./use-user-media\";\nimport { useScreenShare } from \"./use-screen-share\";\nimport { useNetworkInformation } from \"./use-network-information\";\nimport { useMediaQuality, type MediaQuality } from \"./use-media-quality\";\nimport { UseScreenShareOptions } from \"./use-screen-share\";\nimport { UseUserMediaConstraints } from \"./use-user-media\";\nimport { MediaQuality } from \"./use-media-quality\";\n\nexport interface UseConferenceSystemOptions {\n  defaultAutoQuality?: boolean;\n}\n\nexport interface UseConferenceSystemReturns {\n  camera: {\n    stream: MediaStream | null;\n\n    start: (constraints?: UseUserMediaConstraints) => Promise<void>;\n\n    stop: () => void;\n\n    isActive: boolean;\n\n    error: string | null;\n\n    isLoading: boolean;\n  };\n\n  screen: {\n    stream: MediaStream | null;\n\n    start: (options?: UseScreenShareOptions) => Promise<void>;\n\n    stop: () => void;\n\n    isActive: boolean;\n\n    error: string | null;\n  };\n\n  quality: {\n    current: MediaQuality;\n\n    isChanging: boolean;\n\n    set: (level: MediaQuality) => Promise<void>;\n\n    isAuto: boolean;\n\n    toggleAuto: () => void;\n  };\n\n  network: {\n    isOnline: boolean;\n\n    speed: number;\n\n    type: string;\n  };\n}\n\nexport const useConferenceSystem = (\n  options: UseConferenceSystemOptions = {},\n): UseConferenceSystemReturns => {\n  const camera = useUserMedia();\n  const screen = useScreenShare();\n  const network = useNetworkInformation();\n\n  const {\n    quality,\n    setQuality: applyQuality,\n    isChanging: isQualityChanging,\n  } = useMediaQuality(camera.stream);\n\n  const [isAutoQuality, setIsAutoQuality] = useState(\n    options.defaultAutoQuality ?? true,\n  );\n\n  useEffect(() => {\n    if (!isAutoQuality || !camera.stream || !network.networkInfo) return;\n    const { downlink, effectiveType, saveData } = network.networkInfo;\n    let targetQuality: MediaQuality = \"high\";\n\n    if (saveData) {\n      targetQuality = \"low\";\n    } else if (effectiveType === \"2g\" || effectiveType === \"slow-2g\") {\n      targetQuality = \"low\";\n    } else if (downlink && downlink < 1.5) {\n      targetQuality = \"low\";\n    } else if (downlink && downlink < 5) {\n      targetQuality = \"medium\";\n    } else {\n      targetQuality = \"high\";\n    }\n\n    if (quality !== targetQuality) {\n      applyQuality(targetQuality);\n    }\n  }, [\n    network.networkInfo,\n    isAutoQuality,\n    camera.stream,\n    quality,\n    applyQuality,\n  ]);\n\n  return {\n    camera: {\n      stream: camera.stream,\n      start: camera.startCapture,\n      stop: camera.stopCapture,\n      isActive: !!camera.stream,\n      error: camera.error,\n      isLoading: camera.isLoading,\n    },\n    screen: {\n      stream: screen.stream,\n      start: screen.startCapture,\n      stop: screen.stopCapture,\n      isActive: !!screen.stream,\n      error: screen.error,\n    },\n    quality: {\n      current: quality,\n      isChanging: isQualityChanging,\n      set: applyQuality,\n      isAuto: isAutoQuality,\n      toggleAuto: () => setIsAutoQuality((prev) => !prev),\n    },\n    network: {\n      isOnline: network.isOnline,\n      speed: network.networkInfo?.downlink || 0,\n      type: network.networkInfo?.effectiveType || \"unknown\",\n    },\n  };\n};\n",
    "js": "import { useState, useEffect } from \"react\";\nimport { useUserMedia } from \"./use-user-media\";\nimport { useScreenShare } from \"./use-screen-share\";\nimport { useNetworkInformation } from \"./use-network-information\";\nimport { useMediaQuality } from \"./use-media-quality\";\nexport const useConferenceSystem = (options = {}) => {\n    const camera = useUserMedia();\n    const screen = useScreenShare();\n    const network = useNetworkInformation();\n    const { quality, setQuality: applyQuality, isChanging: isQualityChanging, } = useMediaQuality(camera.stream);\n    const [isAutoQuality, setIsAutoQuality] = useState(options.defaultAutoQuality ?? true);\n    useEffect(() => {\n        if (!isAutoQuality || !camera.stream || !network.networkInfo)\n            return;\n        const { downlink, effectiveType, saveData } = network.networkInfo;\n        let targetQuality = \"high\";\n        if (saveData) {\n            targetQuality = \"low\";\n        }\n        else if (effectiveType === \"2g\" || effectiveType === \"slow-2g\") {\n            targetQuality = \"low\";\n        }\n        else if (downlink && downlink < 1.5) {\n            targetQuality = \"low\";\n        }\n        else if (downlink && downlink < 5) {\n            targetQuality = \"medium\";\n        }\n        else {\n            targetQuality = \"high\";\n        }\n        if (quality !== targetQuality) {\n            applyQuality(targetQuality);\n        }\n    }, [\n        network.networkInfo,\n        isAutoQuality,\n        camera.stream,\n        quality,\n        applyQuality,\n    ]);\n    return {\n        camera: {\n            stream: camera.stream,\n            start: camera.startCapture,\n            stop: camera.stopCapture,\n            isActive: !!camera.stream,\n            error: camera.error,\n            isLoading: camera.isLoading,\n        },\n        screen: {\n            stream: screen.stream,\n            start: screen.startCapture,\n            stop: screen.stopCapture,\n            isActive: !!screen.stream,\n            error: screen.error,\n        },\n        quality: {\n            current: quality,\n            isChanging: isQualityChanging,\n            set: applyQuality,\n            isAuto: isAutoQuality,\n            toggleAuto: () => setIsAutoQuality((prev) => !prev),\n        },\n        network: {\n            isOnline: network.isOnline,\n            speed: network.networkInfo?.downlink || 0,\n            type: network.networkInfo?.effectiveType || \"unknown\",\n        },\n    };\n};"
  }
}