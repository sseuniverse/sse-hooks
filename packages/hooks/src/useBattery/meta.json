{
  "$schema": "https://raw.githubusercontent.com/sseuniverse/sse-hooks/refs/heads/main/schema/meta.json",
  "name": "use-battery",
  "type": "registry:hook",
  "title": "useBattery",
  "description": "Represents the state of the battery.",
  "dependencies": [
    "react"
  ],
  "registryDependencies": [],
  "file": {
    "content": "import { useEffect, useState } from \"react\";\n\nexport interface BatteryState {\n  charging: boolean;\n\n  chargingTime: number;\n\n  dischargingTime: number;\n\n  level: number;\n}\n\ninterface BatteryManager extends Readonly<BatteryState>, EventTarget {\n  onchargingchange: () => void;\n  onchargingtimechange: () => void;\n  ondischargingtimechange: () => void;\n  onlevelchange: () => void;\n}\n\ninterface NavigatorWithPossibleBattery extends Navigator {\n  getBattery?: () => Promise<BatteryManager>;\n}\n\ntype UseBatteryState =\n  | { isSupported: false }\n  | { isSupported: true; fetched: false }\n  | (BatteryState & { isSupported: true; fetched: true });\n\nconst nav: NavigatorWithPossibleBattery | undefined =\n  typeof navigator !== \"undefined\" ? navigator : undefined;\n\nconst isBatteryApiSupported = nav && typeof nav.getBattery === \"function\";\n\nfunction useBatteryMock(): UseBatteryState {\n  return { isSupported: false };\n}\n\nfunction useBattery(): UseBatteryState {\n  const [state, setState] = useState<UseBatteryState>({\n    isSupported: true,\n    fetched: false,\n  });\n\n  useEffect(() => {\n    let isMounted = true;\n    let battery: BatteryManager | null = null;\n\n    const handleChange = () => {\n      if (!isMounted || !battery) {\n        return;\n      }\n\n      const newState: UseBatteryState = {\n        isSupported: true,\n        fetched: true,\n        level: battery.level,\n        charging: battery.charging,\n        dischargingTime: battery.dischargingTime,\n        chargingTime: battery.chargingTime,\n      };\n      setState(newState);\n    };\n\n    nav!.getBattery!().then((bat: BatteryManager) => {\n      if (!isMounted) {\n        return;\n      }\n\n      battery = bat;\n      battery.addEventListener(\"chargingchange\", handleChange);\n      battery.addEventListener(\"chargingtimechange\", handleChange);\n      battery.addEventListener(\"dischargingtimechange\", handleChange);\n      battery.addEventListener(\"levelchange\", handleChange);\n      handleChange();\n    });\n\n    return () => {\n      isMounted = false;\n      if (battery) {\n        battery.removeEventListener(\"chargingchange\", handleChange);\n        battery.removeEventListener(\"chargingtimechange\", handleChange);\n        battery.removeEventListener(\"dischargingtimechange\", handleChange);\n        battery.removeEventListener(\"levelchange\", handleChange);\n      }\n    };\n  }, []);\n\n  return state;\n}\n\nconst useBatteryHook = isBatteryApiSupported ? useBattery : useBatteryMock;\n\nexport { useBatteryHook as useBattery };\n",
    "js": "import { useEffect, useState } from \"react\";\nconst nav = typeof navigator !== \"undefined\" ? navigator : undefined;\nconst isBatteryApiSupported = nav && typeof nav.getBattery === \"function\";\nfunction useBatteryMock() {\n    return { isSupported: false };\n}\nfunction useBattery() {\n    const [state, setState] = useState({\n        isSupported: true,\n        fetched: false,\n    });\n    useEffect(() => {\n        let isMounted = true;\n        let battery = null;\n        const handleChange = () => {\n            if (!isMounted || !battery) {\n                return;\n            }\n            const newState = {\n                isSupported: true,\n                fetched: true,\n                level: battery.level,\n                charging: battery.charging,\n                dischargingTime: battery.dischargingTime,\n                chargingTime: battery.chargingTime,\n            };\n            setState(newState);\n        };\n        nav.getBattery().then((bat) => {\n            if (!isMounted) {\n                return;\n            }\n            battery = bat;\n            battery.addEventListener(\"chargingchange\", handleChange);\n            battery.addEventListener(\"chargingtimechange\", handleChange);\n            battery.addEventListener(\"dischargingtimechange\", handleChange);\n            battery.addEventListener(\"levelchange\", handleChange);\n            handleChange();\n        });\n        return () => {\n            isMounted = false;\n            if (battery) {\n                battery.removeEventListener(\"chargingchange\", handleChange);\n                battery.removeEventListener(\"chargingtimechange\", handleChange);\n                battery.removeEventListener(\"dischargingtimechange\", handleChange);\n                battery.removeEventListener(\"levelchange\", handleChange);\n            }\n        };\n    }, []);\n    return state;\n}\nconst useBatteryHook = isBatteryApiSupported ? useBattery : useBatteryMock;\nexport { useBatteryHook as useBattery };"
  }
}