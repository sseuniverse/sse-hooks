{
  "$schema": "https://sse-hooks.vercel.app/api/registry/schema/hook.json",
  "name": "use-resize-observer",
  "type": "registry:hook",
  "title": "useResizeObserver",
  "description": "The size of the observed element.",
  "dependencies": [
    "react"
  ],
  "registryDependencies": [
    "use-is-mounted"
  ],
  "file": {
    "content": "import { useEffect, useRef, useState } from \"react\";\n\nimport type { RefObject } from \"react\";\n\nimport { useIsMounted } from \"./use-is-mounted\";\n\ntype Size = {\n  width: number | undefined;\n\n  height: number | undefined;\n};\n\ntype UseResizeObserverOptions<T extends HTMLElement = HTMLElement> = {\n  ref: RefObject<T>;\n\n  onResize?: (size: Size) => void;\n\n  box?: \"border-box\" | \"content-box\" | \"device-pixel-content-box\";\n};\n\nconst initialSize: Size = {\n  width: undefined,\n  height: undefined,\n};\n\nexport function useResizeObserver<T extends HTMLElement = HTMLElement>(\n  options: UseResizeObserverOptions<T>,\n): Size {\n  const { ref, box = \"content-box\" } = options;\n  const [{ width, height }, setSize] = useState<Size>(initialSize);\n  const isMounted = useIsMounted();\n  const previousSize = useRef<Size>({ ...initialSize });\n  const onResize = useRef<((size: Size) => void) | undefined>(undefined);\n  onResize.current = options.onResize;\n\n  useEffect(() => {\n    if (!ref.current) return;\n\n    if (typeof window === \"undefined\" || !(\"ResizeObserver\" in window)) return;\n\n    const observer = new ResizeObserver(([entry]) => {\n      const boxProp =\n        box === \"border-box\"\n          ? \"borderBoxSize\"\n          : box === \"device-pixel-content-box\"\n            ? \"devicePixelContentBoxSize\"\n            : \"contentBoxSize\";\n\n      const newWidth = extractSize(entry, boxProp, \"inlineSize\");\n      const newHeight = extractSize(entry, boxProp, \"blockSize\");\n\n      const hasChanged =\n        previousSize.current.width !== newWidth ||\n        previousSize.current.height !== newHeight;\n\n      if (hasChanged) {\n        const newSize: Size = { width: newWidth, height: newHeight };\n        previousSize.current.width = newWidth;\n        previousSize.current.height = newHeight;\n\n        if (onResize.current) {\n          onResize.current(newSize);\n        } else {\n          if (isMounted()) {\n            setSize(newSize);\n          }\n        }\n      }\n    });\n\n    observer.observe(ref.current, { box });\n\n    return () => {\n      observer.disconnect();\n    };\n  }, [box, ref, isMounted]);\n\n  return { width, height };\n}\n\ntype BoxSizesKey = keyof Pick<\n  ResizeObserverEntry,\n  \"borderBoxSize\" | \"contentBoxSize\" | \"devicePixelContentBoxSize\"\n>;\n\nfunction extractSize(\n  entry: ResizeObserverEntry,\n  box: BoxSizesKey,\n  sizeType: keyof ResizeObserverSize,\n): number | undefined {\n  if (!entry[box]) {\n    if (box === \"contentBoxSize\") {\n      return entry.contentRect[sizeType === \"inlineSize\" ? \"width\" : \"height\"];\n    }\n    return undefined;\n  }\n\n  return Array.isArray(entry[box])\n    ? entry[box][0][sizeType]\n    : (entry[box][sizeType] as number);\n}\n",
    "js": "import { useEffect, useRef, useState } from \"react\";\nimport { useIsMounted } from \"./use-is-mounted\";\nconst initialSize = {\n    width: undefined,\n    height: undefined,\n};\nexport function useResizeObserver(options) {\n    const { ref, box = \"content-box\" } = options;\n    const [{ width, height }, setSize] = useState(initialSize);\n    const isMounted = useIsMounted();\n    const previousSize = useRef({ ...initialSize });\n    const onResize = useRef(undefined);\n    onResize.current = options.onResize;\n    useEffect(() => {\n        if (!ref.current)\n            return;\n        if (typeof window === \"undefined\" || !(\"ResizeObserver\" in window))\n            return;\n        const observer = new ResizeObserver(([entry]) => {\n            const boxProp = box === \"border-box\"\n                ? \"borderBoxSize\"\n                : box === \"device-pixel-content-box\"\n                    ? \"devicePixelContentBoxSize\"\n                    : \"contentBoxSize\";\n            const newWidth = extractSize(entry, boxProp, \"inlineSize\");\n            const newHeight = extractSize(entry, boxProp, \"blockSize\");\n            const hasChanged = previousSize.current.width !== newWidth ||\n                previousSize.current.height !== newHeight;\n            if (hasChanged) {\n                const newSize = { width: newWidth, height: newHeight };\n                previousSize.current.width = newWidth;\n                previousSize.current.height = newHeight;\n                if (onResize.current) {\n                    onResize.current(newSize);\n                }\n                else {\n                    if (isMounted()) {\n                        setSize(newSize);\n                    }\n                }\n            }\n        });\n        observer.observe(ref.current, { box });\n        return () => {\n            observer.disconnect();\n        };\n    }, [box, ref, isMounted]);\n    return { width, height };\n}\nfunction extractSize(entry, box, sizeType) {\n    if (!entry[box]) {\n        if (box === \"contentBoxSize\") {\n            return entry.contentRect[sizeType === \"inlineSize\" ? \"width\" : \"height\"];\n        }\n        return undefined;\n    }\n    return Array.isArray(entry[box])\n        ? entry[box][0][sizeType]\n        : entry[box][sizeType];\n}"
  }
}